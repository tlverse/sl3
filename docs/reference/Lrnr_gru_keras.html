<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Recurrent Neural Network with Gated Recurrent Unit (GRU) with Keras — Lrnr_gru_keras • sl3</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Recurrent Neural Network with Gated Recurrent Unit (GRU) with Keras — Lrnr_gru_keras"><meta property="og:description" content="This learner supports Recurrent Neural Networks (RNNs) with Gated Recurrent
Units (GRU). This learner leverages the same principles as LSTM networks but
is more streamlined and thus cheaper to run, at the expense of some loss in
representational power. This learner uses the keras package. Note that
all preprocessing, such as differencing and seasonal effects for time
series, should be addressed before using this learner. Desired lags of the
time series should be added as predictors before using the learner."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-115145808-1"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-115145808-1');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sl3</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.4.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="https://tlverse.org" class="external-link">tlverse</a>
</li>
<li>
  <a href="../index.html">sl3</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/intro_sl3.html">Intro to sl3</a>
    </li>
    <li>
      <a href="../articles/SuperLearner_benchmarks.html">sl3 Benchmarks</a>
    </li>
    <li>
      <a href="../slides/sl3-slides.html">sl3 Presentation</a>
    </li>
    <li>
      <a href="../articles/custom_lrnrs.html">Defining Custom sl3 Learners</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/tlverse/sl3/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Recurrent Neural Network with Gated Recurrent Unit (GRU) with Keras</h1>
    <small class="dont-index">Source: <a href="https://github.com/tlverse/sl3/blob/HEAD/R/Lrnr_gru_keras.R" class="external-link"><code>R/Lrnr_gru_keras.R</code></a></small>
    <div class="hidden name"><code>Lrnr_gru_keras.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This learner supports Recurrent Neural Networks (RNNs) with Gated Recurrent
Units (GRU). This learner leverages the same principles as LSTM networks but
is more streamlined and thus cheaper to run, at the expense of some loss in
representational power. This learner uses the <span class="pkg">keras</span> package. Note that
all preprocessing, such as differencing and seasonal effects for time
series, should be addressed before using this learner. Desired lags of the
time series should be added as predictors before using the learner.</p>
    </div>


    <div id="format">
    <h2>Format</h2>
    <p>An <code><a href="https://r6.r-lib.org/reference/R6Class.html" class="external-link">R6Class</a></code> object inheriting from
<code><a href="Lrnr_base.html">Lrnr_base</a></code>.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p>A learner object inheriting from <code><a href="Lrnr_base.html">Lrnr_base</a></code> with
methods for training and prediction. For a full list of learner
functionality, see the complete documentation of <code><a href="Lrnr_base.html">Lrnr_base</a></code>.</p>
    </div>
    <div id="parameters">
    <h2>Parameters</h2>
    

<ul><li><p><code>batch_size</code>: How many times should the training data be used to
train the neural network?</p></li>
<li><p><code>units</code>: Positive integer, dimensionality of the output space.</p></li>
<li><p><code>dropout</code>: Float between 0 and 1. Fraction of the input units to
drop.</p></li>
<li><p><code>recurrent_dropout</code>: Float between 0 and 1. Fraction of the units
to drop for the linear transformation of the recurrent state.</p></li>
<li><p><code>activation</code>: Activation function to use. If you pass NULL, no
activation is applied (e.g., "linear" activation: <code>a(x) = x</code>).</p></li>
<li><p><code>recurrent_activation</code>: Activation function to use for the
recurrent step.</p></li>
<li><p><code>recurrent_out</code>: Activation function to use for the output step.</p></li>
<li><p><code>epochs</code>: Number of epochs to train the model.</p></li>
<li><p><code>lr</code>: Learning rate.</p></li>
<li><p><code>layers</code>: How many LSTM layers. Only allows for 1 or 2.</p></li>
<li><p><code>callbacks</code>: List of callbacks, which is a set of functions to
be applied at given stages of the training procedure. Default callback
function <code>callback_early_stopping</code> stops training if the validation
loss does not improve across <code>patience</code> number of epochs.</p></li>
<li><p><code>...</code>: Other parameters passed to <code><a href="https://keras.rstudio.com/reference/keras.html" class="external-link">keras</a></code>.</p></li>
</ul></div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p>Other Learners: 
<code><a href="Custom_chain.html">Custom_chain</a></code>,
<code><a href="Lrnr_HarmonicReg.html">Lrnr_HarmonicReg</a></code>,
<code><a href="Lrnr_arima.html">Lrnr_arima</a></code>,
<code><a href="Lrnr_bartMachine.html">Lrnr_bartMachine</a></code>,
<code><a href="Lrnr_base.html">Lrnr_base</a></code>,
<code><a href="Lrnr_bayesglm.html">Lrnr_bayesglm</a></code>,
<code><a href="Lrnr_bilstm.html">Lrnr_bilstm</a></code>,
<code><a href="Lrnr_caret.html">Lrnr_caret</a></code>,
<code><a href="Lrnr_cv_selector.html">Lrnr_cv_selector</a></code>,
<code><a href="Lrnr_cv.html">Lrnr_cv</a></code>,
<code><a href="Lrnr_dbarts.html">Lrnr_dbarts</a></code>,
<code><a href="Lrnr_define_interactions.html">Lrnr_define_interactions</a></code>,
<code><a href="Lrnr_density_discretize.html">Lrnr_density_discretize</a></code>,
<code><a href="Lrnr_density_hse.html">Lrnr_density_hse</a></code>,
<code><a href="Lrnr_density_semiparametric.html">Lrnr_density_semiparametric</a></code>,
<code><a href="Lrnr_earth.html">Lrnr_earth</a></code>,
<code><a href="Lrnr_expSmooth.html">Lrnr_expSmooth</a></code>,
<code><a href="Lrnr_gam.html">Lrnr_gam</a></code>,
<code><a href="Lrnr_ga.html">Lrnr_ga</a></code>,
<code><a href="Lrnr_gbm.html">Lrnr_gbm</a></code>,
<code><a href="Lrnr_glm_fast.html">Lrnr_glm_fast</a></code>,
<code><a href="Lrnr_glm_semiparametric.html">Lrnr_glm_semiparametric</a></code>,
<code><a href="Lrnr_glmnet.html">Lrnr_glmnet</a></code>,
<code><a href="Lrnr_glmtree.html">Lrnr_glmtree</a></code>,
<code><a href="Lrnr_glm.html">Lrnr_glm</a></code>,
<code><a href="Lrnr_grf.html">Lrnr_grf</a></code>,
<code><a href="Lrnr_gts.html">Lrnr_gts</a></code>,
<code><a href="Lrnr_h2o_grid.html">Lrnr_h2o_grid</a></code>,
<code><a href="Lrnr_hal9001.html">Lrnr_hal9001</a></code>,
<code><a href="Lrnr_haldensify.html">Lrnr_haldensify</a></code>,
<code><a href="Lrnr_hts.html">Lrnr_hts</a></code>,
<code><a href="Lrnr_independent_binomial.html">Lrnr_independent_binomial</a></code>,
<code><a href="Lrnr_lightgbm.html">Lrnr_lightgbm</a></code>,
<code><a href="Lrnr_lstm_keras.html">Lrnr_lstm_keras</a></code>,
<code><a href="Lrnr_mean.html">Lrnr_mean</a></code>,
<code><a href="Lrnr_multiple_ts.html">Lrnr_multiple_ts</a></code>,
<code><a href="Lrnr_multivariate.html">Lrnr_multivariate</a></code>,
<code><a href="Lrnr_nnet.html">Lrnr_nnet</a></code>,
<code><a href="Lrnr_nnls.html">Lrnr_nnls</a></code>,
<code><a href="Lrnr_optim.html">Lrnr_optim</a></code>,
<code><a href="Lrnr_pca.html">Lrnr_pca</a></code>,
<code><a href="SuperLearner_interface.html">Lrnr_pkg_SuperLearner</a></code>,
<code><a href="Lrnr_polspline.html">Lrnr_polspline</a></code>,
<code><a href="Lrnr_pooled_hazards.html">Lrnr_pooled_hazards</a></code>,
<code><a href="Lrnr_randomForest.html">Lrnr_randomForest</a></code>,
<code><a href="Lrnr_ranger.html">Lrnr_ranger</a></code>,
<code><a href="Lrnr_revere_task.html">Lrnr_revere_task</a></code>,
<code><a href="Lrnr_rpart.html">Lrnr_rpart</a></code>,
<code><a href="Lrnr_rugarch.html">Lrnr_rugarch</a></code>,
<code><a href="Lrnr_screener_augment.html">Lrnr_screener_augment</a></code>,
<code><a href="Lrnr_screener_coefs.html">Lrnr_screener_coefs</a></code>,
<code><a href="Lrnr_screener_correlation.html">Lrnr_screener_correlation</a></code>,
<code><a href="Lrnr_screener_importance.html">Lrnr_screener_importance</a></code>,
<code><a href="Lrnr_sl.html">Lrnr_sl</a></code>,
<code><a href="Lrnr_solnp_density.html">Lrnr_solnp_density</a></code>,
<code><a href="Lrnr_solnp.html">Lrnr_solnp</a></code>,
<code><a href="Lrnr_stratified.html">Lrnr_stratified</a></code>,
<code><a href="Lrnr_subset_covariates.html">Lrnr_subset_covariates</a></code>,
<code><a href="Lrnr_svm.html">Lrnr_svm</a></code>,
<code><a href="Lrnr_tsDyn.html">Lrnr_tsDyn</a></code>,
<code><a href="Lrnr_ts_weights.html">Lrnr_ts_weights</a></code>,
<code><a href="Lrnr_xgboost.html">Lrnr_xgboost</a></code>,
<code><a href="Pipeline.html">Pipeline</a></code>,
<code><a href="Stack.html">Stack</a></code>,
<code><a href="Lrnr_h2o_glm.html">define_h2o_X</a>()</code>,
<code><a href="undocumented_learner.html">undocumented_learner</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tlverse.org/origami/" class="external-link">origami</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">bsds</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># make folds appropriate for time-series cross-validation</span></span>
<span class="r-in"><span class="va">folds</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://tlverse.org/origami/reference/make_folds.html" class="external-link">make_folds</a></span><span class="op">(</span><span class="va">bsds</span>,</span>
<span class="r-in">  fold_fun <span class="op">=</span> <span class="va">folds_rolling_window</span>, window_size <span class="op">=</span> <span class="fl">500</span>,</span>
<span class="r-in">  validation_size <span class="op">=</span> <span class="fl">100</span>, gap <span class="op">=</span> <span class="fl">0</span>, batch <span class="op">=</span> <span class="fl">50</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># build task by passing in external folds structure</span></span>
<span class="r-in"><span class="va">task</span> <span class="op">&lt;-</span> <span class="va"><a href="sl3_Task.html">sl3_Task</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span></span>
<span class="r-in">  data <span class="op">=</span> <span class="va">bsds</span>,</span>
<span class="r-in">  folds <span class="op">=</span> <span class="va">folds</span>,</span>
<span class="r-in">  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span class="r-in">    <span class="st">"weekday"</span>, <span class="st">"temp"</span></span>
<span class="r-in">  <span class="op">)</span>,</span>
<span class="r-in">  outcome <span class="op">=</span> <span class="st">"cnt"</span></span>
<span class="r-in"><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># create tasks for taining and validation (simplifed example)</span></span>
<span class="r-in"><span class="va">train_task</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://tlverse.org/origami/reference/fold_helpers.html" class="external-link">training</a></span><span class="op">(</span><span class="va">task</span>, fold <span class="op">=</span> <span class="va">task</span><span class="op">$</span><span class="va">folds</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"><span class="va">valid_task</span> <span class="op">&lt;-</span> <span class="fu"><a href="http://tlverse.org/origami/reference/fold_helpers.html" class="external-link">validation</a></span><span class="op">(</span><span class="va">task</span>, fold <span class="op">=</span> <span class="va">task</span><span class="op">$</span><span class="va">folds</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># instantiate learner, then fit and predict (simplifed example)</span></span>
<span class="r-in"><span class="va">gru_lrnr</span> <span class="op">&lt;-</span> <span class="va">Lrnr_gru_keras</span><span class="op">$</span><span class="fu">new</span><span class="op">(</span>batch_size <span class="op">=</span> <span class="fl">1</span>, epochs <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></span>
<span class="r-in"><span class="va">gru_fit</span> <span class="op">&lt;-</span> <span class="va">gru_lrnr</span><span class="op">$</span><span class="fu">train</span><span class="op">(</span><span class="va">train_task</span><span class="op">)</span></span>
<span class="r-in"><span class="va">gru_preds</span> <span class="op">&lt;-</span> <span class="va">gru_fit</span><span class="op">$</span><span class="fu">predict</span><span class="op">(</span><span class="va">valid_task</span><span class="op">)</span></span>
<span class="r-in"><span class="op">}</span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Jeremy Coyle, Nima Hejazi, Oleg Sofrygin, Ivana
Malenica, Rachael Phillips.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a>
2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

